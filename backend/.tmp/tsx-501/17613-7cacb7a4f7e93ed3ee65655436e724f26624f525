{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{z}from\"zod\";import{QUESTIONNAIRE_QUESTIONS,generateRecommendations}from\"../lib/questionnaireData.js\";import{questionnaireStore}from\"../lib/questionnaireStore.js\";const answerSchema=z.record(z.boolean());const saveSchema=z.object({userId:z.string().min(1),role:z.enum([\"architect\",\"developer\",\"tester\",\"business-analyst\",\"executive\"]),answers:answerSchema});function registerQuestionnaireRoutes(app){app.get(\"/questionnaire/questions\",async()=>({questions:QUESTIONNAIRE_QUESTIONS}));app.get(\"/questionnaire\",async(request,reply)=>{const userId=request.query?.userId;if(!userId){return reply.badRequest(\"Missing userId query parameter.\")}const record=questionnaireStore.get(userId);if(!record){return reply.notFound(\"No questionnaire data found for the supplied user.\")}return record});app.post(\"/questionnaire\",async(request,reply)=>{const parseResult=saveSchema.safeParse(request.body);if(!parseResult.success){return reply.badRequest(\"Invalid questionnaire payload.\")}const{userId,role,answers}=parseResult.data;const recommendations=generateRecommendations(answers,role);const record=questionnaireStore.save({userId,role,answers,recommendations,createdAt:\"\",updatedAt:\"\"});return record});app.put(\"/questionnaire\",async(request,reply)=>{const parseResult=saveSchema.safeParse(request.body);if(!parseResult.success){return reply.badRequest(\"Invalid questionnaire payload.\")}const{userId,role,answers}=parseResult.data;const recommendations=generateRecommendations(answers,role);const record=questionnaireStore.save({userId,role,answers,recommendations,createdAt:\"\",updatedAt:\"\"});return record})}__name(registerQuestionnaireRoutes,\"registerQuestionnaireRoutes\");export{registerQuestionnaireRoutes};\n","warnings":[],"map":{"version":3,"mappings":"kHACA,OAAS,MAAS,MAElB,OACE,wBAEA,4BACK,8BACP,OACE,uBAEK,+BAGP,MAAM,aAAe,EAAE,OAAO,EAAE,QAAQ,CAAC,EAEzC,MAAM,WAAa,EAAE,OAAO,CAC1B,OAAQ,EAAE,OAAO,EAAE,IAAI,CAAC,EACxB,KAAM,EAAE,KAAK,CACX,YACA,YACA,SACA,mBACA,WACF,CAAC,EACD,QAAS,YACX,CAAC,EAEM,SAAS,4BAA4B,IAAsB,CAChE,IAAI,IAAI,2BAA4B,UAAa,CAC/C,UAAW,uBACb,EAAE,EAEF,IAAI,IAAI,iBAAkB,MAAO,QAAS,QAAU,CAClD,MAAM,OAAU,QAAQ,OAA8C,OAEtE,GAAI,CAAC,OAAQ,CACX,OAAO,MAAM,WAAW,iCAAiC,CAC3D,CAEA,MAAM,OAAS,mBAAmB,IAAI,MAAM,EAC5C,GAAI,CAAC,OAAQ,CACX,OAAO,MAAM,SAAS,oDAAoD,CAC5E,CAEA,OAAO,MACT,CAAC,EAED,IAAI,KAAK,iBAAkB,MAAO,QAAS,QAAU,CACnD,MAAM,YAAc,WAAW,UAAU,QAAQ,IAAI,EAErD,GAAI,CAAC,YAAY,QAAS,CACxB,OAAO,MAAM,WAAW,gCAAgC,CAC1D,CAEA,KAAM,CAAE,OAAQ,KAAM,OAAQ,EAAI,YAAY,KAM9C,MAAM,gBAAkB,wBAAwB,QAAS,IAAI,EAC7D,MAAM,OAAS,mBAAmB,KAAK,CACrC,OACA,KACA,QACA,gBACA,UAAW,GACX,UAAW,EACb,CAAC,EAED,OAAO,MACT,CAAC,EAED,IAAI,IAAI,iBAAkB,MAAO,QAAS,QAAU,CAClD,MAAM,YAAc,WAAW,UAAU,QAAQ,IAAI,EAErD,GAAI,CAAC,YAAY,QAAS,CACxB,OAAO,MAAM,WAAW,gCAAgC,CAC1D,CAEA,KAAM,CAAE,OAAQ,KAAM,OAAQ,EAAI,YAAY,KAM9C,MAAM,gBAAkB,wBAAwB,QAAS,IAAI,EAC7D,MAAM,OAAS,mBAAmB,KAAK,CACrC,OACA,KACA,QACA,gBACA,UAAW,GACX,UAAW,EACb,CAAC,EAED,OAAO,MACT,CAAC,CACH,CAvEgB","names":[],"ignoreList":[],"sources":["/Users/ck/OwaspRatRemake/backend/src/routes/questionnaire.ts"],"sourcesContent":[null]}}