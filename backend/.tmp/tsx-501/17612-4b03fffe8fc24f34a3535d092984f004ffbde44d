{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{z}from\"zod\";import{getAsvsChecklist,asvsMetadata}from\"../lib/asvsData.js\";const checklistRequestSchema=z.object({level:z.enum([\"L1\",\"L2\",\"L3\"]),applicationType:z.enum([\"web\",\"mobile\",\"api\"]),role:z.enum([\"architect\",\"developer\",\"tester\",\"business-analyst\",\"executive\"])});function registerChecklistRoutes(app){app.post(\"/checklists\",async(request,reply)=>{const parseResult=checklistRequestSchema.safeParse(request.body);if(!parseResult.success){return reply.badRequest(\"Invalid checklist request payload\")}const{level,applicationType,role}=parseResult.data;const tasks=getAsvsChecklist(level,applicationType,role);return{metadata:{...asvsMetadata,filters:{level,applicationType,role},resultCount:tasks.length},tasks:tasks.map(task=>({id:task.id,shortcode:task.shortcode,level:`L${task.level}`,category:task.category,categoryShortcode:task.categoryShortcode,section:task.section,sectionShortcode:task.sectionShortcode,description:task.description,recommendedRoles:task.recommendedRoles,applicationTypes:task.applicationTypes}))}})}__name(registerChecklistRoutes,\"registerChecklistRoutes\");export{registerChecklistRoutes};\n","warnings":[],"map":{"version":3,"mappings":"kHACA,OAAS,MAAS,MAElB,OACE,iBAGA,iBACK,qBAGP,MAAM,uBAAyB,EAAE,OAAO,CACtC,MAAO,EAAE,KAAK,CAAC,KAAM,KAAM,IAAI,CAAC,EAChC,gBAAiB,EAAE,KAAK,CAAC,MAAO,SAAU,KAAK,CAAC,EAChD,KAAM,EAAE,KAAK,CACX,YACA,YACA,SACA,mBACA,WACF,CAAC,CACH,CAAC,EAEM,SAAS,wBAAwB,IAAsB,CAC5D,IAAI,KAAK,cAAe,MAAO,QAAS,QAAU,CAChD,MAAM,YAAc,uBAAuB,UAAU,QAAQ,IAAI,EAEjE,GAAI,CAAC,YAAY,QAAS,CACxB,OAAO,MAAM,WAAW,mCAAmC,CAC7D,CAEA,KAAM,CAAE,MAAO,gBAAiB,IAAK,EAAI,YAAY,KAMrD,MAAM,MAAQ,iBAAiB,MAAO,gBAAiB,IAAI,EAE3D,MAAO,CACL,SAAU,CACR,GAAG,aACH,QAAS,CAAE,MAAO,gBAAiB,IAAK,EACxC,YAAa,MAAM,MACrB,EACA,MAAO,MAAM,IAAK,OAAU,CAC1B,GAAI,KAAK,GACT,UAAW,KAAK,UAChB,MAAO,IAAI,KAAK,KAAK,GACrB,SAAU,KAAK,SACf,kBAAmB,KAAK,kBACxB,QAAS,KAAK,QACd,iBAAkB,KAAK,iBACvB,YAAa,KAAK,YAClB,iBAAkB,KAAK,iBACvB,iBAAkB,KAAK,gBACzB,EAAE,CACJ,CACF,CAAC,CACH,CApCgB","names":[],"ignoreList":[],"sources":["/Users/ck/OwaspRatRemake/backend/src/routes/checklists.ts"],"sourcesContent":[null]}}