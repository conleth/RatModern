{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{z}from\"zod\";import{getAsvsChecklist,asvsMetadata,ASVS_CATEGORIES}from\"../lib/asvsData.js\";const checklistRequestSchema=z.object({level:z.enum([\"L1\",\"L2\",\"L3\"]),applicationType:z.enum([\"web\",\"mobile\",\"api\"]),role:z.enum([\"architect\",\"developer\",\"tester\",\"business-analyst\",\"executive\"]),technology:z.enum([\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\",\"swift\"]).optional().nullable(),discipline:z.enum([\"frontend\",\"backend\",\"mobile\",\"fullstack\",\"data-analyst\",\"devops\",\"security-engineer\",\"qa-engineer\",\"project-manager\"]).optional().nullable(),categories:z.array(z.string()).optional().nullable()});function registerChecklistRoutes(app){app.get(\"/checklists/categories\",async()=>({categories:ASVS_CATEGORIES}));app.post(\"/checklists\",async(request,reply)=>{const parseResult=checklistRequestSchema.safeParse(request.body);if(!parseResult.success){return reply.badRequest(\"Invalid checklist request payload\")}const{level,applicationType,role,technology,discipline,categories}=parseResult.data;const tasks=getAsvsChecklist(level,applicationType,role,{technology:technology??void 0,discipline:discipline??void 0,categories:categories?.map(category=>category.toUpperCase())??void 0});return{metadata:{...asvsMetadata,filters:{level,applicationType,role,technology:technology??null,discipline:discipline??null,categories:categories??null},resultCount:tasks.length},tasks:tasks.map(task=>({id:task.id,shortcode:task.shortcode,level:`L${task.level}`,category:task.category,categoryShortcode:task.categoryShortcode,section:task.section,sectionShortcode:task.sectionShortcode,description:task.description,recommendedRoles:task.recommendedRoles,applicationTypes:task.applicationTypes,disciplines:task.disciplines,technologies:task.technologies}))}})}__name(registerChecklistRoutes,\"registerChecklistRoutes\");export{registerChecklistRoutes};\n","warnings":[],"map":{"version":3,"mappings":"kHACA,OAAS,MAAS,MAElB,OACE,iBAKA,aACA,oBACK,qBAGP,MAAM,uBAAyB,EAAE,OAAO,CACtC,MAAO,EAAE,KAAK,CAAC,KAAM,KAAM,IAAI,CAAC,EAChC,gBAAiB,EAAE,KAAK,CAAC,MAAO,SAAU,KAAK,CAAC,EAChD,KAAM,EAAE,KAAK,CACX,YACA,YACA,SACA,mBACA,WACF,CAAC,EACD,WAAY,EACT,KAAK,CACJ,aACA,aACA,SACA,OACA,SACA,KACA,OACA,MACA,SACA,OACF,CAAC,EACA,SAAS,EACT,SAAS,EACZ,WAAY,EACT,KAAK,CACJ,WACA,UACA,SACA,YACA,eACA,SACA,oBACA,cACA,iBACF,CAAC,EACA,SAAS,EACT,SAAS,EACZ,WAAY,EACT,MAAM,EAAE,OAAO,CAAC,EAChB,SAAS,EACT,SAAS,CACd,CAAC,EAEM,SAAS,wBAAwB,IAAsB,CAC5D,IAAI,IAAI,yBAA0B,UAAa,CAC7C,WAAY,eACd,EAAE,EAEF,IAAI,KAAK,cAAe,MAAO,QAAS,QAAU,CAChD,MAAM,YAAc,uBAAuB,UAAU,QAAQ,IAAI,EAEjE,GAAI,CAAC,YAAY,QAAS,CACxB,OAAO,MAAM,WAAW,mCAAmC,CAC7D,CAEA,KAAM,CAAE,MAAO,gBAAiB,KAAM,WAAY,WAAY,UAAW,EACvE,YAAY,KASd,MAAM,MAAQ,iBAAiB,MAAO,gBAAiB,KAAM,CAC3D,WAAY,YAAc,OAC1B,WAAY,YAAc,OAC1B,WACE,YAAY,IAAK,UAAa,SAAS,YAAY,CAAC,GAAK,MAC7D,CAAC,EAED,MAAO,CACL,SAAU,CACR,GAAG,aACH,QAAS,CACP,MACA,gBACA,KACA,WAAY,YAAc,KAC1B,WAAY,YAAc,KAC1B,WAAY,YAAc,IAC5B,EACA,YAAa,MAAM,MACrB,EACA,MAAO,MAAM,IAAK,OAAU,CAC1B,GAAI,KAAK,GACT,UAAW,KAAK,UAChB,MAAO,IAAI,KAAK,KAAK,GACrB,SAAU,KAAK,SACf,kBAAmB,KAAK,kBACxB,QAAS,KAAK,QACd,iBAAkB,KAAK,iBACvB,YAAa,KAAK,YAClB,iBAAkB,KAAK,iBACvB,iBAAkB,KAAK,iBACvB,YAAa,KAAK,YAClB,aAAc,KAAK,YACrB,EAAE,CACJ,CACF,CAAC,CACH,CA1DgB","names":[],"ignoreList":[],"sources":["/Users/ck/OwaspRatRemake/backend/src/routes/checklists.ts"],"sourcesContent":[null]}}