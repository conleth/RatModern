{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{readFileSync}from\"fs\";import path from\"path\";import{fileURLToPath}from\"url\";const __filename=fileURLToPath(import.meta.url);const __dirname=path.dirname(__filename);const DATA_PATH=path.join(__dirname,\"../data/spvs-1.0.0-en.csv\");function parseCsv(content){const rows=[];let currentRow=[];let currentValue=\"\";let inQuotes=false;for(let index=0;index<content.length;index+=1){const char=content[index];const nextChar=content[index+1];if(char==='\"'){if(inQuotes&&nextChar==='\"'){currentValue+='\"';index+=1}else{inQuotes=!inQuotes}continue}if(char===\",\"&&!inQuotes){currentRow.push(currentValue);currentValue=\"\";continue}if((char===\"\\n\"||char===\"\\r\")&&!inQuotes){if(char===\"\\r\"&&nextChar===\"\\n\"){index+=1}currentRow.push(currentValue);currentValue=\"\";if(currentRow.some(value=>value!==\"\")){rows.push(currentRow)}currentRow=[];continue}currentValue+=char}if(currentValue.length>0||currentRow.length>0){currentRow.push(currentValue)}if(currentRow.length>0&&currentRow.some(value=>value!==\"\")){rows.push(currentRow)}return rows.map(row=>row.map(value=>value.trim()))}__name(parseCsv,\"parseCsv\");const rawRows=parseCsv(readFileSync(DATA_PATH,{encoding:\"utf-8\"}));const[,...dataRows]=rawRows;const categoryMap=new Map;const subcategoryMap=new Map;const requirements=dataRows.map(row=>{const[categoryId,categoryName,subcategoryId,subcategoryName,requirementId,requirementDescription,level1Flag,level2Flag,level3Flag,nistMapping,owaspRisk,cweMapping,cweDescription]=row;if(!categoryId||categoryId===\"-\"||!requirementId){return void 0}const normalizedCategoryId=categoryId.toUpperCase();const normalizedSubcategoryId=subcategoryId?.toUpperCase()??\"\";if(normalizedCategoryId&&!categoryMap.has(normalizedCategoryId)&&categoryName){categoryMap.set(normalizedCategoryId,{id:normalizedCategoryId,name:categoryName})}if(normalizedSubcategoryId&&!subcategoryMap.has(normalizedSubcategoryId)&&subcategoryName){subcategoryMap.set(normalizedSubcategoryId,{id:normalizedSubcategoryId,name:subcategoryName,categoryId:normalizedCategoryId})}const levels=[];if(level1Flag?.toUpperCase()===\"X\"){levels.push(\"L1\")}if(level2Flag?.toUpperCase()===\"X\"){levels.push(\"L2\")}if(level3Flag?.toUpperCase()===\"X\"){levels.push(\"L3\")}const description=requirementDescription?.replace(/\\s+/g,\" \").trim()??\"\";return{id:requirementId,description,categoryId:normalizedCategoryId,categoryName:categoryName??\"\",subcategoryId:normalizedSubcategoryId,subcategoryName:subcategoryName??\"\",levels:levels.length>0?levels:[\"L1\",\"L2\",\"L3\"],nistMapping:nistMapping??\"\",owaspRisk:owaspRisk??\"\",cweMapping:cweMapping??\"\",cweDescription:cweDescription??\"\"}}).filter(requirement=>Boolean(requirement));const SPVS_REQUIREMENTS=requirements;const SPVS_CATEGORIES=Array.from(categoryMap.values()).sort((a,b)=>a.id.localeCompare(b.id,void 0,{numeric:true}));const SPVS_SUBCATEGORIES=Array.from(subcategoryMap.values()).sort((a,b)=>a.id.localeCompare(b.id,void 0,{numeric:true}));const spvsMetadata={name:\"Secure Pipeline Verification Standard\",shortName:\"SPVS\",version:\"1.0.0\",totalRequirements:SPVS_REQUIREMENTS.length};function matchesSearch(requirement,search){if(!search){return true}const normalized=search.trim().toLowerCase();if(!normalized){return true}const haystack=[requirement.id,requirement.description,requirement.categoryName,requirement.subcategoryName,requirement.nistMapping,requirement.owaspRisk,requirement.cweMapping,requirement.cweDescription].join(\" \").toLowerCase();return haystack.includes(normalized)}__name(matchesSearch,\"matchesSearch\");function getSpvsRequirements(filters){const levelSet=filters?.levels?.length?new Set(filters.levels.map(level=>level.toUpperCase())):void 0;const categorySet=filters?.categories?.length?new Set(filters.categories.map(category=>category.toUpperCase())):void 0;const subcategorySet=filters?.subcategories?.length?new Set(filters.subcategories.map(subcategory=>subcategory.toUpperCase())):void 0;return SPVS_REQUIREMENTS.filter(requirement=>{if(levelSet){const hasLevel=requirement.levels.some(level=>levelSet.has(level));if(!hasLevel){return false}}if(categorySet&&!categorySet.has(requirement.categoryId)){return false}if(subcategorySet&&requirement.subcategoryId&&!subcategorySet.has(requirement.subcategoryId)){return false}return matchesSearch(requirement,filters?.search)})}__name(getSpvsRequirements,\"getSpvsRequirements\");export{SPVS_CATEGORIES,SPVS_REQUIREMENTS,SPVS_SUBCATEGORIES,getSpvsRequirements,spvsMetadata};\n","warnings":[],"map":{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["/Users/ck/OwaspRatRemake/backend/src/lib/spvsData.ts"],"sourcesContent":[null]}}