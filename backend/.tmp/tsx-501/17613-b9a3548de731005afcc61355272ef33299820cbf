{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{readFileSync}from\"fs\";import path from\"path\";import{fileURLToPath}from\"url\";const __filename=fileURLToPath(import.meta.url);const __dirname=path.dirname(__filename);const DATA_PATH=path.join(__dirname,\"../data/asvs-5.0.0-en.json\");const rawDocument=JSON.parse(readFileSync(DATA_PATH,{encoding:\"utf-8\"}));const ALL_ROLES=[\"architect\",\"developer\",\"tester\",\"business-analyst\",\"data-scientist\",\"executive\"];const ALL_APPLICATION_TYPES=[\"web\",\"mobile\",\"api\"];const SECTION_ROLE_MAP={V1:[\"architect\",\"developer\",\"business-analyst\",\"data-scientist\",\"executive\"],V2:[\"architect\",\"developer\",\"tester\",\"data-scientist\"],V3:[\"architect\",\"developer\",\"tester\",\"data-scientist\"],V4:[\"architect\",\"developer\",\"tester\",\"data-scientist\"],V5:[\"developer\",\"tester\",\"data-scientist\"],V6:[\"developer\",\"tester\",\"data-scientist\"],V7:[\"developer\",\"tester\",\"data-scientist\"],V8:[\"developer\",\"tester\",\"data-scientist\"],V9:[\"developer\",\"tester\",\"data-scientist\"],V10:[\"architect\",\"tester\",\"data-scientist\"],V11:[\"architect\",\"tester\"],V12:[\"architect\",\"tester\",\"data-scientist\"],V13:[\"architect\",\"developer\",\"tester\",\"data-scientist\"],V14:[\"architect\",\"business-analyst\",\"executive\",\"data-scientist\"]};const SECTION_APPLICATION_MAP={V1:[\"web\",\"mobile\",\"api\"],V2:[\"web\",\"mobile\",\"api\"],V3:[\"web\",\"mobile\",\"api\"],V4:[\"web\",\"mobile\",\"api\"],V5:[\"web\",\"mobile\",\"api\"],V6:[\"web\",\"mobile\",\"api\"],V7:[\"web\",\"mobile\",\"api\"],V8:[\"web\",\"mobile\"],V9:[\"web\",\"mobile\"],V10:[\"web\",\"mobile\",\"api\"],V11:[\"web\",\"mobile\"],V12:[\"web\",\"mobile\"],V13:[\"web\",\"api\"],V14:[\"web\",\"mobile\",\"api\"]};const SECTION_DISCIPLINE_MAP={V1:[\"frontend\",\"backend\",\"mobile\",\"fullstack\",\"data-analyst\",\"data-scientist\",\"project-manager\",\"security-engineer\"],V2:[\"backend\",\"fullstack\",\"security-engineer\",\"data-analyst\",\"data-scientist\"],V3:[\"backend\",\"mobile\",\"security-engineer\",\"data-analyst\",\"data-scientist\"],V4:[\"backend\",\"security-engineer\",\"data-analyst\",\"data-scientist\"],V5:[\"frontend\",\"backend\",\"fullstack\",\"security-engineer\",\"qa-engineer\",\"data-scientist\"],V6:[\"backend\",\"data-analyst\",\"data-scientist\",\"security-engineer\"],V7:[\"backend\",\"devops\",\"security-engineer\",\"data-scientist\"],V8:[\"backend\",\"data-analyst\",\"data-scientist\",\"security-engineer\"],V9:[\"backend\",\"devops\",\"security-engineer\",\"data-analyst\",\"data-scientist\"],V10:[\"backend\",\"mobile\",\"devops\",\"security-engineer\",\"data-scientist\"],V11:[\"frontend\",\"backend\",\"project-manager\",\"fullstack\",\"data-scientist\"],V12:[\"backend\",\"devops\",\"security-engineer\",\"data-scientist\"],V13:[\"backend\",\"mobile\",\"fullstack\",\"security-engineer\",\"data-scientist\"],V14:[\"backend\",\"devops\",\"project-manager\",\"security-engineer\",\"data-analyst\",\"data-scientist\"]};const SECTION_TECHNOLOGY_MAP={V1:[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\",\"swift\"],V2:[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\"],V3:[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\"],V4:[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\"],V5:[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\"],V6:[\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\"],V7:[\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\",\"swift\"],V8:[\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\"],V9:[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\"],V10:[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"kotlin\",\"swift\"],V11:[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\"],V12:[\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\"],V13:[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\"],V14:[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\",\"swift\"]};const flattenedControls=rawDocument.Requirements.flatMap(requirement=>{const categoryRoles=SECTION_ROLE_MAP[requirement.Shortcode]??ALL_ROLES;const categoryApplications=SECTION_APPLICATION_MAP[requirement.Shortcode]??ALL_APPLICATION_TYPES;return requirement.Items.flatMap(section=>{return section.Items.map(item=>{const level=Number.parseInt(item.L,10);const sectionDisciplines=SECTION_DISCIPLINE_MAP[requirement.Shortcode]??SECTION_DISCIPLINE_MAP.V1;const sectionTechnologies=SECTION_TECHNOLOGY_MAP[requirement.Shortcode]??SECTION_TECHNOLOGY_MAP.V1;return{id:item.Shortcode,shortcode:item.Shortcode,description:item.Description,level:Number.isNaN(level)?3:level,category:requirement.Name,categoryShortcode:requirement.Shortcode,section:section.Name,sectionShortcode:section.Shortcode,ordinal:{category:requirement.Ordinal,section:section.Ordinal,item:item.Ordinal},recommendedRoles:categoryRoles,applicationTypes:categoryApplications,disciplines:sectionDisciplines,technologies:sectionTechnologies}})})});const controlsById=new Map(flattenedControls.map(control=>[control.id,control]));const categoryMap=new Map;rawDocument.Requirements.forEach(requirement=>{categoryMap.set(requirement.Shortcode,{shortcode:requirement.Shortcode,name:requirement.Name,ordinal:requirement.Ordinal})});const ASVS_CATEGORIES=Array.from(categoryMap.values()).sort((a,b)=>a.ordinal-b.ordinal);function levelToNumber(level){switch(level){case\"L1\":return 1;case\"L2\":return 2;case\"L3\":default:return 3}}__name(levelToNumber,\"levelToNumber\");function getAsvsControlById(id){return controlsById.get(id)}__name(getAsvsControlById,\"getAsvsControlById\");function getAsvsChecklist(level,applicationType,role,options){const maximumLevel=levelToNumber(level);const categoriesFilter=options?.categories?.length?new Set(options.categories.map(category=>category.toUpperCase())):void 0;return flattenedControls.filter(control=>{if(control.level>maximumLevel){return false}if(!control.recommendedRoles.includes(role)){return false}if(!control.applicationTypes.includes(applicationType)){return false}if(categoriesFilter&&!categoriesFilter.has(control.categoryShortcode.toUpperCase())){return false}if(options?.discipline){if(!control.disciplines.includes(options.discipline)){return false}}if(options?.technology){if(!control.technologies.includes(options.technology)){return false}}return true}).sort((a,b)=>{if(a.categoryShortcode===b.categoryShortcode){if(a.sectionShortcode===b.sectionShortcode){return a.ordinal.item-b.ordinal.item}return a.ordinal.section-b.ordinal.section}return a.ordinal.category-b.ordinal.category})}__name(getAsvsChecklist,\"getAsvsChecklist\");const asvsMetadata={name:rawDocument.Name,shortName:rawDocument.ShortName,version:rawDocument.Version,description:rawDocument.Description,totalControls:flattenedControls.length};const TECHNOLOGY_TAGS=[\"typescript\",\"javascript\",\"python\",\"java\",\"csharp\",\"go\",\"ruby\",\"php\",\"kotlin\",\"swift\"];const DEVELOPER_DISCIPLINES=[\"frontend\",\"backend\",\"mobile\",\"fullstack\",\"data-analyst\",\"devops\",\"security-engineer\",\"qa-engineer\",\"project-manager\"];export{ASVS_CATEGORIES,DEVELOPER_DISCIPLINES,TECHNOLOGY_TAGS,asvsMetadata,getAsvsChecklist,getAsvsControlById};\n","warnings":[],"map":{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["/Users/ck/OwaspRatRemake/backend/src/lib/asvsData.ts"],"sourcesContent":[null]}}